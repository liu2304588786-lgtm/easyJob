<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeJob æ‹›è˜èšåˆå™¨</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 font-sans text-slate-900 pb-20">

    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="bg-slate-900 text-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="bg-blue-600 p-1.5 rounded-lg">
                    <!-- SVG Icon: Send -->
                    <svg class="h-5 w-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" /></svg>
                </div>
                <span class="font-bold text-xl tracking-tight">DeJob <span class="text-blue-400 font-light">Aggregator</span></span>
            </div>
            <div class="flex items-center gap-4 text-sm text-slate-400">
                <span class="hidden sm:inline">æ•°æ®æº: t.me/DeJob_official</span>
                <div class="flex items-center gap-1">
                    <!-- çŠ¶æ€æŒ‡ç¤ºå™¨ -->
                    <div id="statusIndicator" class="h-2 w-2 rounded-full bg-yellow-500 animate-pulse"></div>
                    <span id="statusText" class="text-xs">Connecting...</span>
                </div>
            </div>
        </div>
    </header>

    <!-- ä¸»ä½“å†…å®¹ -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 py-8">
        
        <!-- è§†å›¾å®¹å™¨ -->
        <div id="main-view" class="flex flex-col lg:flex-row gap-8">
            
            <!-- å·¦ä¾§ï¼šèŒä½åˆ—è¡¨ -->
            <div class="flex-1">
                
                <!-- ç­›é€‰æ  -->
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 mb-6 sticky top-20 z-40">
                    <div class="flex flex-col md:flex-row gap-4 justify-between items-center">
                        <!-- æœç´¢ -->
                        <div class="relative w-full md:w-1/3">
                            <svg class="absolute left-3 top-2.5 h-4 w-4 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                            <input type="text" id="searchInput" placeholder="æœç´¢ Marisa, Solidity..." class="w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm transition-all">
                        </div>
                        
                        <!-- ä¸‹æ‹‰ç­›é€‰ -->
                        <div class="flex gap-2 w-full md:w-auto overflow-x-auto pb-1 md:pb-0">
                            <select id="categorySelect" class="px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-600 focus:outline-none cursor-pointer">
                                <option value="All">æ‰€æœ‰å²—ä½</option>
                                <option value="Dev">å¼€å‘ (Dev)</option>
                                <option value="Design">è®¾è®¡ (Design)</option>
                                <option value="Marketing">å¸‚åœº (Marketing)</option>
                                <option value="Operation">è¿è¥ (Operation)</option>
                            </select>
                            <select id="typeSelect" class="px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm text-slate-600 focus:outline-none cursor-pointer">
                                <option value="All">æ‰€æœ‰æ–¹å¼</option>
                                <option value="å…¨èŒ">å…¨èŒ</option>
                                <option value="å…¼èŒ">å…¼èŒ</option>
                                <option value="è¿œç¨‹">è¿œç¨‹</option>
                                <option value="å®ä¹ ">å®ä¹ </option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- åˆ—è¡¨å¤´éƒ¨ -->
                <div class="flex justify-between items-center mb-4 px-1">
                    <button onclick="toggleSelectAll()" id="selectAllBtn" class="text-sm font-medium text-blue-600 hover:text-blue-800 transition-colors">
                        å…¨é€‰æœ¬é¡µ
                    </button>
                    <span id="jobCount" class="text-xs text-slate-400">åŠ è½½ä¸­...</span>
                </div>

                <!-- èŒä½åˆ—è¡¨å®¹å™¨ -->
                <div id="jobList" class="space-y-4">
                    <!-- JS å°†åœ¨è¿™é‡ŒåŠ¨æ€æ¸²æŸ“èŒä½å¡ç‰‡ -->
                    <div class="text-center py-10 text-slate-400 animate-pulse">æ­£åœ¨ä»åç«¯è·å–æ•°æ®...</div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šä¾§è¾¹æ  (æ“ä½œåŒº) -->
            <div class="w-full lg:w-80 flex-shrink-0">
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-5 sticky top-20">
                    <h2 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                        <svg class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" /></svg>
                        æŠ•é€’åŠ©æ‰‹
                    </h2>

                    <!-- ç®€å†ä¸Šä¼ åŒºåŸŸ -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-slate-700 mb-2">ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ ç®€å† (PDF)</label>
                        <div class="relative group">
                            <input type="file" id="resumeInput" accept=".pdf" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10">
                            <div id="dropZone" class="border-2 border-dashed border-slate-300 rounded-lg p-4 text-center transition-colors bg-slate-50 group-hover:border-blue-400">
                                <!-- æœªä¸Šä¼ çŠ¶æ€ -->
                                <div id="uploadPlaceholder">
                                    <svg class="h-6 w-6 mx-auto mb-2 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" /></svg>
                                    <p class="text-sm text-slate-500">ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ </p>
                                </div>
                                <!-- å·²ä¸Šä¼ çŠ¶æ€ (é»˜è®¤éšè—) -->
                                <div id="fileInfo" class="hidden flex items-center justify-center gap-2 text-green-700">
                                    <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                                    <span id="fileName" class="text-sm font-medium truncate max-w-[150px]"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- é€‰ä¸­ç»Ÿè®¡ -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-slate-700 mb-2">ç¬¬äºŒæ­¥ï¼šé€‰æ‹©èŒä½</label>
                        <div class="bg-slate-50 rounded-lg p-3 flex justify-between items-center border border-slate-100">
                            <span class="text-sm text-slate-600">å·²é€‰èŒä½</span>
                            <span id="selectedCount" class="text-xl font-bold text-blue-600">0</span>
                        </div>
                    </div>

                    <!-- æŠ•é€’æŒ‰é’® -->
                    <button id="applyBtn" onclick="startApplying()" disabled class="w-full py-3 px-4 rounded-lg font-bold text-white shadow-lg shadow-blue-500/30 transition-all bg-slate-300 cursor-not-allowed">
                        ä¸€é”®æŠ•é€’
                    </button>
                    <p class="mt-4 text-xs text-slate-400 text-center">æç¤ºï¼šç³»ç»Ÿå°†è‡ªåŠ¨è§£æèŒä½é‚®ç®±å¹¶å‘é€ç®€å†ã€‚</p>
                </div>
            </div>
        </div>

        <!-- å‘é€è¿›åº¦è§†å›¾ (é»˜è®¤éšè—) -->
        <div id="sending-view" class="hidden max-w-2xl mx-auto bg-white rounded-xl shadow-lg border border-slate-100 overflow-hidden">
            <div class="p-6 border-b border-slate-100 flex justify-between items-center">
                <h2 class="text-xl font-bold text-slate-800" id="progressTitle">æŠ•é€’ä»»åŠ¡é˜Ÿåˆ—</h2>
                <button onclick="resetView()" class="text-sm text-blue-600 hover:underline">è¿”å›åˆ—è¡¨</button>
            </div>
            
            <div class="h-1.5 w-full bg-slate-100">
                <div id="progressBar" class="h-full bg-green-500 transition-all duration-300 ease-out" style="width: 0%"></div>
            </div>

            <div id="logContainer" class="max-h-[500px] overflow-y-auto p-0">
                <!-- æ—¥å¿—å°†æ’å…¥è¿™é‡Œ -->
            </div>
        </div>

    </main>

    <!-- JavaScript é€»è¾‘ -->
    <script>
        // --- æ¼”ç¤º/å…œåº•æ•°æ® (å½“åç«¯æ–­å¼€æ—¶ä½¿ç”¨) ---
        // è¿™é‡Œçš„ title ä½¿ç”¨äº† "Marisa" è¿™ç§é¡¹ç›®åæ ¼å¼ï¼Œè€Œä¸æ˜¯ä¹‹å‰çš„ "Solidity Engineer"
        const FALLBACK_JOBS = [
            { id: 1, title: "Marisa (ç¤ºä¾‹)", company: "DeFi Protocol X", type: "å…¨èŒ", location: "è¿œç¨‹ (Global)", tags: ["Dev", "Solidity"], salary: "1800U", date: "2023-11-01", email: "hr@marisa-project.io", source: "Mock Data" },
            { id: 2, title: "GameFi Studio", company: "GameFi Studio", type: "å…¼èŒ", location: "è¿œç¨‹ (APAC)", tags: ["Marketing"], salary: "2000U", date: "2023-10-23", email: "jobs@very-long-domain-name-example.com", source: "Mock Data" },
        ];

        // --- çŠ¶æ€ç®¡ç† ---
        let currentJobs = [];
        let selectedIds = new Set();
        let resumeFile = null;
        // åç«¯ API åœ°å€
        const API_BASE_URL = 'http://localhost:5000/api'; 

        // --- åˆå§‹åŒ– ---
        document.addEventListener('DOMContentLoaded', () => {
            loadJobsData(); // å°è¯•åŠ è½½çœŸå®æ•°æ®
            setupEventListeners();
        });

        // --- æ•°æ®åŠ è½½æ ¸å¿ƒé€»è¾‘ (å«é”™è¯¯å¤„ç†) ---
        async function loadJobsData() {
            const listEl = document.getElementById('jobList');
            const statusIndicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');

            try {
                // 1. å°è¯•ä» Python åç«¯è·å–æ•°æ®
                const response = await fetch(`${API_BASE_URL}/jobs`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                if (Array.isArray(data) && data.length > 0) {
                    currentJobs = data;
                    console.log("æˆåŠŸè¿æ¥åç«¯ï¼ŒåŠ è½½äº†", data.length, "æ¡æ•°æ®");
                    
                    // æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨ï¼šç»¿è‰² (Live)
                    statusIndicator.className = "h-2 w-2 rounded-full bg-green-500 animate-pulse";
                    statusText.innerText = "Live Connected";
                } else {
                    console.log("åç«¯è¿”å›ç©ºæ•°æ®ï¼Œä½¿ç”¨æ¼”ç¤ºæ•°æ®");
                    currentJobs = [...FALLBACK_JOBS];
                    statusText.innerText = "Live (Empty)";
                }

            } catch (error) {
                // 2. å¦‚æœè¿æ¥å¤±è´¥ï¼ˆæŠ¥é”™ï¼‰ï¼Œå›é€€åˆ°æ¼”ç¤ºæ•°æ®
                console.warn("è¿æ¥åç«¯å¤±è´¥ï¼Œå·²åˆ‡æ¢åˆ°æ¼”ç¤ºæ¨¡å¼ã€‚é”™è¯¯è¯¦æƒ…:", error);
                
                currentJobs = [...FALLBACK_JOBS];
                
                // æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨ï¼šç°è‰² (Demo Mode)
                statusIndicator.className = "h-2 w-2 rounded-full bg-slate-400";
                statusText.innerText = "Demo Mode";
            }
            
            renderJobs();
        }
        
        // æ¸²æŸ“èŒä½åˆ—è¡¨
        function renderJobs() {
            const listEl = document.getElementById('jobList');
            const searchVal = document.getElementById('searchInput').value.toLowerCase();
            const catVal = document.getElementById('categorySelect').value;
            const typeVal = document.getElementById('typeSelect').value;

            // ç­›é€‰
            const filteredJobs = currentJobs.filter(job => {
                const title = (job.title || "").toLowerCase();
                const raw = (job.raw_content || "").toLowerCase(); // å…è®¸æœç´¢åŸå§‹å†…å®¹
                const tags = Array.isArray(job.tags) ? job.tags : [];
                const type = job.type || "";

                const matchSearch = title.includes(searchVal) || raw.includes(searchVal);
                const matchCat = catVal === 'All' || tags.some(t => t.includes(catVal));
                const matchType = typeVal === 'All' || type.includes(typeVal);
                return matchSearch && matchCat && matchType;
            });

            // æ›´æ–° UI ç»Ÿè®¡
            document.getElementById('jobCount').innerText = `æ˜¾ç¤º ${filteredJobs.length} æ¡æ•°æ®`;
            
            // æ¸…ç©ºåˆ—è¡¨
            listEl.innerHTML = '';

            if (filteredJobs.length === 0) {
                listEl.innerHTML = `<div class="text-center py-10 text-slate-400">æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„èŒä½</div>`;
                return;
            }

            // ç”Ÿæˆ HTML
            filteredJobs.forEach(job => {
                const isSelected = selectedIds.has(job.id);
                const card = document.createElement('div');
                card.className = `fade-in group relative bg-white rounded-xl p-5 border transition-all duration-200 hover:shadow-md ${isSelected ? 'border-blue-500 ring-1 ring-blue-500 bg-blue-50/10' : 'border-slate-100'}`;
                card.onclick = (e) => toggleSelect(job.id, e);
                
                // æ ‡ç­¾ HTML
                const tags = Array.isArray(job.tags) ? job.tags : [];
                const tagsHtml = tags.map(tag => 
                    `<span class="px-2 py-1 rounded text-xs font-medium bg-slate-100 text-slate-600 mr-2">#${tag}</span>`
                ).join('');

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3 pointer-events-none">
                        <div class="flex gap-3 items-start overflow-hidden">
                            <div class="mt-1 h-5 w-5 flex-shrink-0 rounded border flex items-center justify-center transition-colors ${isSelected ? 'bg-blue-500 border-blue-500' : 'border-slate-300 bg-white'}">
                                ${isSelected ? '<svg class="h-3.5 w-3.5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" /></svg>' : ''}
                            </div>
                            <div class="min-w-0">
                                <!-- æ ‡é¢˜ï¼šæ”¯æŒæˆªæ–­ï¼Œé˜²æ­¢è¿‡é•¿æ’‘ç ´ -->
                                <h3 class="font-bold text-slate-800 text-lg group-hover:text-blue-600 transition-colors truncate pr-2" title="${job.title || "æœªçŸ¥é¡¹ç›®"}">
                                    ${job.title || "æœªçŸ¥é¡¹ç›®"}
                                </h3>
                                <div class="text-slate-500 text-sm mt-1 font-medium">${job.date || ""}</div>
                            </div>
                        </div>
                        <div class="flex flex-col items-end gap-2 flex-shrink-0">
                           <!-- è–ªèµ„æ°”æ³¡ -->
                           <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold bg-green-100 text-green-800">
                             ${job.salary || "é¢è®®"}
                           </span>
                        </div>
                    </div>
                    <div class="pl-8 pointer-events-none">
                        <div class="flex flex-wrap gap-x-4 gap-y-2 text-sm text-slate-500 mb-4">
                            <span class="flex items-center gap-1">ğŸ¢ ${job.type || "å…¶ä»–"}</span>
                            
                            <!-- ä¿®å¤ï¼šé‚®ç®±ä½¿ç”¨ break-all å¼ºåˆ¶æ¢è¡Œï¼Œå»æ‰ truncateï¼Œç¡®ä¿å®Œæ•´æ˜¾ç¤º -->
                            <span class="flex items-center gap-1 text-blue-600 break-all">
                                ğŸ“§ ${job.email || "æ— é‚®ç®±"}
                            </span>
                        </div>
                        <div class="flex flex-wrap gap-2 mb-3">${tagsHtml}</div>
                        
                        <!-- åŸå§‹å†…å®¹é¢„è§ˆï¼ˆå¯é€‰ï¼‰ -->
                        <div class="text-xs text-slate-400 mt-2 line-clamp-2 bg-slate-50 p-2 rounded">
                           ${(job.raw_content || "").substring(0, 100)}...
                        </div>
                    </div>
                `;
                listEl.appendChild(card);
            });
            updateActionState();
        }

        // äº¤äº’é€»è¾‘ï¼šé€‰æ‹©èŒä½
        function toggleSelect(id) {
            if (selectedIds.has(id)) {
                selectedIds.delete(id);
            } else {
                selectedIds.add(id);
            }
            renderJobs(); // é‡æ–°æ¸²æŸ“ä»¥æ›´æ–°æ ·å¼
        }

        // äº¤äº’é€»è¾‘ï¼šå…¨é€‰/åé€‰
        function toggleSelectAll() {
            const btn = document.getElementById('selectAllBtn');
            const searchVal = document.getElementById('searchInput').value.toLowerCase();
            const filteredJobs = currentJobs.filter(job => 
                (job.title || "").toLowerCase().includes(searchVal) || 
                (job.raw_content || "").toLowerCase().includes(searchVal)
            );
            
            const allIds = filteredJobs.map(j => j.id);
            const allSelected = allIds.every(id => selectedIds.has(id));
            
            if (allSelected) {
                allIds.forEach(id => selectedIds.delete(id));
                btn.innerText = "å…¨é€‰æœ¬é¡µ";
            } else {
                allIds.forEach(id => selectedIds.add(id));
                btn.innerText = "å–æ¶ˆå…¨é€‰";
            }
            renderJobs();
        }

        // äº¤äº’é€»è¾‘ï¼šæ–‡ä»¶ä¸Šä¼ 
        function setupEventListeners() {
            ['searchInput', 'categorySelect', 'typeSelect'].forEach(id => {
                document.getElementById(id).addEventListener('input', renderJobs);
            });

            const fileInput = document.getElementById('resumeInput');
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                handleFile(file);
            });
        }

        function handleFile(file) {
            if (file && file.type === 'application/pdf') {
                resumeFile = file;
                document.getElementById('uploadPlaceholder').classList.add('hidden');
                document.getElementById('fileInfo').classList.remove('hidden');
                document.getElementById('fileName').innerText = file.name;
                document.getElementById('dropZone').classList.add('border-green-400', 'bg-green-50');
            } else {
                alert('è¯·ä¸Šä¼  PDF æ ¼å¼çš„æ–‡ä»¶');
            }
            updateActionState();
        }

        // æ›´æ–°æŒ‰é’®çŠ¶æ€
        function updateActionState() {
            const btn = document.getElementById('applyBtn');
            const countEl = document.getElementById('selectedCount');
            const count = selectedIds.size;
            
            countEl.innerText = count;

            if (count > 0 && resumeFile) {
                btn.disabled = false;
                btn.classList.remove('bg-slate-300', 'cursor-not-allowed');
                btn.classList.add('bg-blue-600', 'hover:bg-blue-700', 'hover:-translate-y-0.5');
                btn.innerText = `ä¸€é”®æŠ•é€’ (${count})`;
            } else {
                btn.disabled = true;
                btn.classList.add('bg-slate-300', 'cursor-not-allowed');
                btn.classList.remove('bg-blue-600', 'hover:bg-blue-700', 'hover:-translate-y-0.5');
                btn.innerText = "ä¸€é”®æŠ•é€’";
            }
        }

        // æ¨¡æ‹Ÿ + çœŸå®æŠ•é€’è¿‡ç¨‹
        async function startApplying() {
            if (!resumeFile || selectedIds.size === 0) return;

            document.getElementById('main-view').classList.add('hidden');
            document.getElementById('sending-view').classList.remove('hidden');
            
            const logContainer = document.getElementById('logContainer');
            const progressBar = document.getElementById('progressBar');
            const progressTitle = document.getElementById('progressTitle');
            
            logContainer.innerHTML = '';
            
            // å‘åç«¯å‘é€è¯·æ±‚
            const jobIds = Array.from(selectedIds);
            fetch(`${API_BASE_URL}/send-resume`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ jobIds: jobIds }) 
            }).catch(err => console.error("åç«¯æŠ•é€’æ¥å£æŠ¥é”™ (ä»…æ¼”ç¤º):", err));

            const jobsToApply = currentJobs.filter(j => selectedIds.has(j.id));
            let completed = 0;

            for (const job of jobsToApply) {
                await new Promise(r => setTimeout(r, 600));
                
                const success = true; 
                const time = new Date().toLocaleTimeString();
                
                const logItem = document.createElement('div');
                logItem.className = "fade-in p-4 border-b border-slate-50 flex items-center justify-between hover:bg-slate-50";
                logItem.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="text-green-500 font-bold">âœ” Sent</span>
                        <div class="min-w-0">
                            <div class="font-medium text-slate-800 text-sm truncate w-40 sm:w-64" title="${job.email}">${job.email}</div>
                        </div>
                    </div>
                `;
                logContainer.prepend(logItem);

                completed++;
                const percent = Math.round((completed / jobsToApply.length) * 100);
                progressBar.style.width = `${percent}%`;
                progressTitle.innerText = `Sending... ${percent}%`;
            }
            
            progressTitle.innerText = "Finished";
        }

        function resetView() {
            document.getElementById('sending-view').classList.add('hidden');
            document.getElementById('main-view').classList.remove('hidden');
        }

    </script>
</body>
</html>